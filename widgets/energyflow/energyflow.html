<div class="energyflow-container">
  <svg viewBox="0 0 760 360" xmlns="http://www.w3.org/2000/svg" class="energyflow-svg">

    <!-- ═══ FLOW PATHS (drawn behind nodes) ═══ -->

    <!-- Solar → Haus (top to center, downward) -->
    <path data-flow="solar-house"
          class="flow-path"
          d="M 380,115 L 380,162"/>

    <!-- Grid ↔ Haus (left to center, horizontal) -->
    <!-- Same path used for Bezug (forward) and Einspeisung (reverse) -->
    <path data-flow="grid-house"
          class="flow-path"
          d="M 140,200 L 332,200"/>

    <!-- Haus → WP (center to right, horizontal) -->
    <path data-flow="house-heatpump"
          class="flow-path"
          d="M 428,200 L 620,200"/>

    <!-- Haus ↔ Akku (center to bottom, downward) -->
    <!-- Same path: forward = charging, reverse = discharging -->
    <path data-flow="house-battery"
          class="flow-path"
          d="M 380,238 L 380,292"/>

    <!-- ═══ NODES ═══ -->

    <!-- Solar: top center (380, 75) -->
    <g class="ef-node" id="node-solar" transform="translate(380,75)">
      <circle class="node-circle solar" r="40"/>
      <text class="node-icon" font-family="FontAwesome" font-size="22" text-anchor="middle" dy="-10">&#xf185;</text>
      <text class="node-label" text-anchor="middle" dy="5">Solar</text>
      <text class="node-value" id="val-solar" text-anchor="middle" dy="19">-- W</text>
      <text class="node-kwh" id="val-solar-kwh" text-anchor="middle" dy="31">-- kWh</text>
    </g>

    <!-- Grid: left middle (90, 200) -->
    <g class="ef-node" id="node-grid" transform="translate(90,200)">
      <circle class="node-circle grid" r="40"/>
      <text class="node-icon" font-family="FontAwesome" font-size="22" text-anchor="middle" dy="-10">&#xf0e7;</text>
      <text class="node-label" id="lbl-grid" text-anchor="middle" dy="5">Netz</text>
      <text class="node-value" id="val-grid" text-anchor="middle" dy="19">-- W</text>
      <text class="node-kwh" id="val-grid-kwh" text-anchor="middle" dy="31">-- kWh</text>
    </g>

    <!-- Haus: center (380, 200) -->
    <g class="ef-node" id="node-house" transform="translate(380,200)">
      <circle class="node-circle house" r="46"/>
      <text class="node-icon" font-family="FontAwesome" font-size="26" text-anchor="middle" dy="-6">&#xf015;</text>
      <text class="node-label" text-anchor="middle" dy="12">Haus</text>
      <text class="node-value" id="val-house" text-anchor="middle" dy="28">-- W</text>
    </g>

    <!-- Wärmepumpe: right middle (670, 200) -->
    <g class="ef-node" id="node-heatpump" transform="translate(670,200)">
      <circle class="node-circle heatpump" r="40"/>
      <!-- Fan icon: 3-blade propeller -->
      <g transform="translate(0,-14)" fill="rgba(255,255,255,0.9)">
        <g transform="rotate(0)">  <ellipse cx="2" cy="-5" rx="2.5" ry="6"/></g>
        <g transform="rotate(120)"><ellipse cx="2" cy="-5" rx="2.5" ry="6"/></g>
        <g transform="rotate(240)"><ellipse cx="2" cy="-5" rx="2.5" ry="6"/></g>
        <circle r="2.5"/>
      </g>
      <text class="node-label" text-anchor="middle" dy="5">WP</text>
      <text class="node-value" id="val-heatpump" text-anchor="middle" dy="19">-- W</text>
      <text class="node-kwh" id="val-heatpump-kwh" text-anchor="middle" dy="31">-- kWh</text>
    </g>

    <!-- Akku: bottom center (380, 330) -->
    <g class="ef-node" id="node-battery" transform="translate(380,330)">
      <circle class="node-circle battery" r="40"/>
      <text class="node-icon" font-family="FontAwesome" font-size="22" text-anchor="middle" dy="-8">&#xf240;</text>
      <text class="node-soc" id="val-soc" text-anchor="middle" dy="6">--%</text>
      <text class="node-value" id="val-battery" text-anchor="middle" dy="22">-- W</text>
    </g>

    <!-- ═══ WEATHER PANEL (top-right) ═══ -->
    <g id="weather-panel">
      <!-- Current weather: icon + temperature -->
      <text id="weather-icon"
            class="weather-icon"
            x="471" y="44"
            text-anchor="middle">--</text>
      <text id="weather-temp"
            class="weather-temp"
            x="497" y="44">--°</text>

      <!-- Wind speed -->
      <text id="weather-wind"
            class="weather-wind"
            x="497" y="60">-- km/h</text>

      <!-- Separator line -->
      <line class="weather-separator" x1="455" y1="68" x2="752" y2="68"/>

      <!-- Forecast 1 -->
      <g id="fc1-group" transform="translate(490, 0)">
        <text id="fc1-day"  class="weather-fc-day"  x="0" y="83">---</text>
        <text id="fc1-icon" class="weather-fc-icon" x="0" y="100">--</text>
        <text id="fc1-temp" class="weather-fc-temp" x="0" y="114">--</text>
      </g>

      <!-- Forecast 2 -->
      <g id="fc2-group" transform="translate(625, 0)">
        <text id="fc2-day"  class="weather-fc-day"  x="0" y="83">---</text>
        <text id="fc2-icon" class="weather-fc-icon" x="0" y="100">--</text>
        <text id="fc2-temp" class="weather-fc-temp" x="0" y="114">--</text>
      </g>
    </g>

  </svg>
</div>

<p class="updated-at" data-bind="updatedAtMessage"></p>
